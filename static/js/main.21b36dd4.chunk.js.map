{"version":3,"sources":["Setup.js","Dashboard.js","utils.js","App.js","index.js"],"names":["Setup","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","rows","keys","store","accessData","length","_this2","_loop","i","env","push","react_default","a","createElement","style","display","key","TextField_default","required","defaultValue","accessToken","onChange","e","target","value","label","width","accountId","Paper_default","padding","name","Button_default","variant","color","marginRight","onClick","setState","assign","marginLeft","pop","Component","fetchOandaEndpoint","url","fetch","headers","Authorization","concat","then","result","json","getApiBase","getAccountsTransactions","accounts","Promise","all","map","account","jsonResult","pages","pageUrl","jsonResponse","transactions","flattenedTransactions","forEach","getAccountTransactions","getAccountsSummary","getAccountSummary","Dashboard","data","updateWindowDimensions","bind","assertThisInitialized","transactionsByDay","transaction","type","day","moment","time","format","undefined","pl","plByDay","sort","dayKey","reduce","b","profitByDay","x","y","Math","round","cumulativeProfitByDay","lastTotalProfit","summaries","nav","summary","unrealizedPL","results","finalResult","balance","p","mode","line","document","title","updateIntevalSeconds","_this3","clearInterval","updateInteval","setInterval","update","nextProps","makeUpdateInterval","window","addEventListener","height","textAlign","margin","react_plotly_default","layout","autosize","windowHeight","showlegend","useResizeHandler","removeEventListener","windowWidth","innerWidth","innerHeight","encodeObject","obj","btoa","unescape","encodeURIComponent","JSON","stringify","App","page","location","hash","substring","parse","decodeURIComponent","escape","atob","AppBar_default","position","Toolbar_default","Typography_default","flexGrow","IconButton_default","preventedDefault","preventDefault","ChevronRight_default","Select_default","MenuItem_default","ChevronLeft_default","src_Setup","src_Dashboard","ReactDOM","render","src_App_0","getElementById"],"mappings":"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","file":"static/js/main.21b36dd4.chunk.js","sourcesContent":["import React, { Component } from 'react'\n\nimport TextField from '@material-ui/core/TextField'\nimport Paper from '@material-ui/core/Paper'\nimport Button from '@material-ui/core/Button'\n\nclass Setup extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      rows: Object.keys(props.store.accessData).length || 1\n    }\n  }\n\n  render() {\n    let rows = []\n    for(let i=0;i<this.state.rows;i++) {\n      if(!this.props.store.accessData[i]) this.props.store.accessData[i] = {env: 'live'}\n      rows.push(\n        <div style={{display: 'flex'}} key={i}>\n          <TextField\n            required\n            defaultValue={this.props.store.accessData[i] ? this.props.store.accessData[i].accessToken : ''}\n            onChange={(e) => this.props.store.accessData[i].accessToken = e.target.value}\n            label=\"Account Access Token\"\n            style={{width: '100%'}}\n          />\n          <TextField\n            required\n            defaultValue={this.props.store.accessData[i] ? this.props.store.accessData[i].accountId : ''}\n            onChange={(e) => this.props.store.accessData[i].accountId = e.target.value}\n            label=\"Account ID\"\n            style={{width: '100%'}}\n          />\n          <TextField\n            required\n            defaultValue={this.props.store.accessData[i] ? this.props.store.accessData[i].env : ''}\n            onChange={(e) => this.props.store.accessData[i].env = e.target.value}\n            label=\"Env\"\n            style={{width: '100%'}}\n          />\n        </div>\n      )\n    }\n\n    return (\n      <Paper>\n        <div style={{padding: '10px'}}>\n          <TextField\n            required\n            defaultValue={this.props.store.name ? this.props.store.name : ''}\n            onChange={(e) => this.props.store.name = e.target.value}\n            label=\"Dashboard Name\"\n            style={{width: '100%'}}\n          />\n        </div>\n\n        <div style={{padding: '10px'}}>\n          {rows}\n        </div>\n\n        <div style={{display: 'flex', padding: '10px'}}>\n          <Button variant=\"contained\" color=\"primary\" style={{width: '100%', marginRight: '5px'}}\n            onClick={(e) => this.setState(Object.assign(this.state, {rows: this.state.rows + 1}))}\n          >\n            Add row\n          </Button>\n          <Button variant=\"contained\" color=\"secondary\" style={{width: '100%', marginLeft: '5px'}}\n            onClick={(e) => {\n              if(this.state.rows > 1) {\n                this.setState(Object.assign(this.state, {rows: this.state.rows - 1}))\n                this.props.store.accessData.pop()\n              }\n            }}\n          >\n            Remove row\n          </Button>\n        </div>\n      </Paper>\n    )\n  }\n}\n\nexport default Setup\n","import React, { Component } from 'react'\nimport './App.css'\n\nimport * as moment from 'moment'\nimport Plot from 'react-plotly.js'\n\nimport Paper from '@material-ui/core/Paper'\n\nfunction fetchOandaEndpoint(url, accessToken) {\n  return fetch(url, {\n    headers: {\n      'Authorization': `Bearer ${accessToken}`\n    }\n  }).then((result) => {\n    return result.json()\n  })\n}\n\nfunction getApiBase(env) {\n  if(env === 'practice')\n    return 'https://api-fxpractice.oanda.com'\n  else if(env === 'live')\n    return 'https://api-fxtrade.oanda.com'\n}\n\nfunction getAccountTransactions(account) {\n  let url = `${getApiBase(account.env)}/v3/accounts/${account.accountId}/transactions`\n\n  return fetchOandaEndpoint(url, account.accessToken)\n    .then((jsonResult) => {\n      return Promise.all(jsonResult.pages.map((pageUrl) => {\n        return fetchOandaEndpoint(pageUrl, account.accessToken)\n          .then((jsonResponse) => {\n            return jsonResponse.transactions\n          })\n      }))\n        .then((transactions) => {\n          let flattenedTransactions = []\n          transactions.forEach((result) => flattenedTransactions = flattenedTransactions.concat(result))\n\n          return flattenedTransactions\n        })\n    })\n}\n\nfunction getAccountsTransactions(accounts) {\n  return Promise.all(accounts.map((account) => {\n    return getAccountTransactions(account)\n  }))\n    .then((transactions) => {\n      let flattenedTransactions = []\n      transactions.forEach((result) => flattenedTransactions = flattenedTransactions.concat(result))\n\n      return flattenedTransactions\n    })\n}\n\nfunction getAccountSummary(account) {\n  let url = `${getApiBase(account.env)}/v3/accounts/${account.accountId}/summary`\n\n  return fetchOandaEndpoint(url, account.accessToken)\n}\n\nfunction getAccountsSummary(accounts) {\n  return Promise.all(accounts.map((account) => {\n    return getAccountSummary(account)\n  }))\n}\n\nclass Dashboard extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      data: null\n    }\n\n    this.updateWindowDimensions = this.updateWindowDimensions.bind(this)\n  }\n\n  update() {\n    return Promise.all([\n      getAccountsTransactions(this.props.store.accessData)\n      .then((transactions) => {\n        let transactionsByDay = {}\n        transactions.forEach((transaction) => {\n          if(transaction.type === \"ORDER_FILL\") {\n            let day = moment(transaction.time).format('YYYY-MM-DD')\n\n            if(transactionsByDay[day] === undefined) transactionsByDay[day] = []\n            transactionsByDay[day].push(+transaction.pl)\n          }\n        })\n\n        let plByDay = {}\n        Object.keys(transactionsByDay).sort().forEach(dayKey => {\n          plByDay[dayKey] = transactionsByDay[dayKey].reduce((a, b) => a + b, 0)\n        })\n\n        let profitByDay = []\n        Object.keys(transactionsByDay).forEach(dayKey => {\n          profitByDay.push({\n            x: dayKey,\n            y: Math.round(plByDay[dayKey] * 100) / 100\n          })\n        })\n\n        let cumulativeProfitByDay = []\n        let lastTotalProfit = 0\n        Object.keys(transactionsByDay).forEach(dayKey => {\n          let y = lastTotalProfit + plByDay[dayKey]\n          lastTotalProfit = y\n\n          cumulativeProfitByDay.push({\n            x: dayKey,\n            y: Math.round(y * 100) / 100\n          })\n        })\n\n        return {\n          name: 'balance',\n          profitByDay: profitByDay,\n          cumulativeProfitByDay: cumulativeProfitByDay\n        }\n      }),\n      getAccountsSummary(this.props.store.accessData)\n        .then((summaries) => {\n          return {\n            name: 'nav',\n            nav: Math.round(100 *\n              summaries.map((summary) => +summary.account.pl + +summary.account.unrealizedPL).reduce((a, b) => a + b, 0)\n            ) / 100\n          }\n        })\n    ])\n      .then((results) => {\n        let finalResult = {}\n        results.forEach((result) => {\n          finalResult[result.name] = result\n          delete finalResult[result.name].name\n        })\n\n        return finalResult\n      })\n      .then((result) => {\n        this.setState(Object.assign(this.state, {\n          data: [\n            {\n              name: 'Balance',\n              x: result.balance.cumulativeProfitByDay.map((p) => p.x),\n              y: result.balance.cumulativeProfitByDay.map((p) => p.y),\n              mode: 'lines'\n            },\n            {\n              name: 'NAV',\n              line: {\n                  color: 'rgb(0, 194, 0)'\n              },\n              x: [\n                result.balance.cumulativeProfitByDay[result.balance.cumulativeProfitByDay.length - 2].x,\n                result.balance.cumulativeProfitByDay[result.balance.cumulativeProfitByDay.length - 1].x\n              ],\n              y: [\n                result.balance.cumulativeProfitByDay[result.balance.cumulativeProfitByDay.length - 2].y,\n                result.nav.nav\n              ]\n            }\n          ]\n        }))\n\n        document.title = this.props.store.name + ': ' + result.nav.nav\n      })\n  }\n\n  makeUpdateInterval(updateIntevalSeconds) {\n    clearInterval(this.updateInteval)\n    if(updateIntevalSeconds !== 0) {\n      this.updateInteval = setInterval(() => {\n        this.update()\n      }, 1000 * updateIntevalSeconds)\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    this.makeUpdateInterval(nextProps.updateIntevalSeconds)\n  }\n\n  componentDidMount() {\n    this.update()\n    this.makeUpdateInterval(this.props.updateIntevalSeconds)\n\n    this.updateWindowDimensions()\n    window.addEventListener('resize', this.updateWindowDimensions)\n  }\n\n  render() {\n    return (\n      <div style={{width: '100%', height: '100%'}}>\n        {!this.state.data &&\n          <div style={{textAlign: 'center', margin: '25px'}}>Loading...</div>\n        }\n        {this.state.data &&\n          <Paper>\n            <Plot\n              data={this.state.data}\n              layout={{\n                autosize: true,\n                title: this.props.store.name,\n                height: this.state.windowHeight - 64,\n                showlegend: false\n              }}\n              useResizeHandler={true}\n              style={{width: '100%'}}\n            />\n          </Paper>\n        }\n      </div>\n    )\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener('resize', this.updateWindowDimensions)\n    clearInterval(this.updateInteval)\n  }\n\n  updateWindowDimensions() {\n    this.setState(Object.assign(this.state, {\n      windowWidth: window.innerWidth, windowHeight: window.innerHeight\n    }))\n  }\n}\n\nexport default Dashboard\n","export function encodeObject(obj) {\n  return btoa(unescape(encodeURIComponent(JSON.stringify(obj))));\n}\nexport function decodeObject(obj) {\n  return JSON.parse(decodeURIComponent(escape(window.atob(obj))));\n}\n","import React, { Component } from 'react'\n\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport ChevronRight from '@material-ui/icons/ChevronRight'\nimport ChevronLeft from '@material-ui/icons/ChevronLeft'\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport Setup from './Setup'\nimport Dashboard from './Dashboard'\n\nimport { encodeObject, decodeObject } from './utils.js'\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.store = {\n      accessData: [],\n      name: ''\n    }\n    this.state = {\n      page: 'setup',\n      updateIntevalSeconds: 0\n    }\n  }\n\n  componentWillMount() {\n    if(window.location.hash) {\n      this.store = decodeObject(window.location.hash.substring(1))\n      this.setState(Object.assign(this.state, {\n        page: 'dashboard',\n        updateIntevalSeconds: this.store.updateIntevalSeconds || this.state.updateIntevalSeconds\n      }))\n    }\n  }\n\n  render() {\n    return(\n      <div>\n        <AppBar position=\"static\">\n          <Toolbar>\n            <Typography variant=\"title\" color=\"inherit\">\n              {this.state.page === 'setup' && 'Oanda Dashboard Setup'}\n              {this.state.page === 'dashboard' && 'Oanda Dashboard'}\n            </Typography>\n            <div style={{flexGrow: 1}}></div>\n            <div>\n              {this.state.page === 'setup' && (\n                <IconButton style={{color: 'white'}} onClick={(e) => {\n                  let preventedDefault = false\n                  for(let i=0;i<this.store.accessData.length;i++) {\n                    if(!this.store.accessData[i].accessToken ||\n                      !this.store.accessData[i].accountId ||\n                      !this.store.accessData[i].env) {\n                        e.preventDefault()\n                        preventedDefault = true\n                    }\n                  }\n                  if(!this.store.name) {\n                    e.preventDefault()\n                    preventedDefault = true\n                  }\n\n                  if(!preventedDefault) {\n                    window.location.hash = encodeObject(this.store)\n                    this.setState(Object.assign(this.state, {\n                      page: 'dashboard'\n                    }))\n                  }\n                }}>\n                  <ChevronRight />\n                </IconButton>\n              )}\n              {this.state.page === 'dashboard' && (\n                <div>\n                  <Select\n                    value={this.state.updateIntevalSeconds}\n                    onChange={(e) => {\n                      this.store.updateIntevalSeconds = e.target.value\n                      window.location.hash = encodeObject(this.store)\n\n                      this.setState(Object.assign(this.state, {\n                        updateIntevalSeconds: e.target.value\n                      }))\n                    }}\n                  >\n                    <MenuItem value={0}>Never</MenuItem>\n                    <MenuItem value={5}>5 Seconds</MenuItem>\n                    <MenuItem value={30}>30 Seconds</MenuItem>\n                    <MenuItem value={60}>60 Seconds</MenuItem>\n                    <MenuItem value={60*5}>5 Minutes</MenuItem>\n                    <MenuItem value={60*15}>15 Minutes</MenuItem>\n                    <MenuItem value={60*60}>1 Hour</MenuItem>\n                  </Select>\n                  <IconButton style={{color: 'white'}} onClick={() => {\n                    this.setState(Object.assign(this.state, {\n                      page: 'setup'\n                    }))\n                  }}>\n                    <ChevronLeft />\n                  </IconButton>\n                </div>\n              )}\n            </div>\n          </Toolbar>\n        </AppBar>\n\n        {this.state.page === 'setup' && <Setup store={this.store} />}\n        {this.state.page === 'dashboard' && <Dashboard store={this.store} updateIntevalSeconds={this.state.updateIntevalSeconds} />}\n      </div>\n    )\n  }\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nReactDOM.render((<App />), document.getElementById('root'))\n"],"sourceRoot":""}